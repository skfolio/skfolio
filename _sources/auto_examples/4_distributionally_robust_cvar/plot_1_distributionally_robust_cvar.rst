
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/4_distributionally_robust_cvar/plot_1_distributionally_robust_cvar.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_4_distributionally_robust_cvar_plot_1_distributionally_robust_cvar.py>`
        to download the full example code. or to run this example in your browser via Binder

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_4_distributionally_robust_cvar_plot_1_distributionally_robust_cvar.py:


============================
Distributionally Robust CVaR
============================

This tutorial introduces the :class:`~skfolio.optimization.DistributionallyRobustCVaR`
model.

The Distributionally Robust CVaR model constructs a Wasserstein ball in the space of
multivariate and non-discrete probability distributions centered at the uniform
distribution on the training samples, and find the allocation that minimize the CVaR of
the worst-case distribution within this Wasserstein ball.

Mohajerin Esfahani and Kuhn (2018) proved that for piecewise linear objective functions,
which is the case of CVaR (Rockafellar and Uryasev), the distributionally robust
optimization problem over Wasserstein ball can be reformulated as finite convex
programs.

It's advised to use a solver that handles a high number of constraints like `Mosek`.
For accessibility, this example uses the default open source solver `CLARABEL`, so to
increase convergence speed, we only use 3 years of data.

The radius of the Wasserstein ball is controlled with the `wasserstein_ball_radius`
parameter. Increasing the radius will increase the uncertainty about the
distribution, bringing the weights closer to the equal weighted portfolio.

.. GENERATED FROM PYTHON SOURCE LINES 29-33

Data
====
We load the S&P 500 :ref:`dataset <datasets>` composed of the daily prices of 20
assets from the S&P 500 Index composition starting from 2020-01-02 up to 2022-12-28:

.. GENERATED FROM PYTHON SOURCE LINES 33-47

.. code-block:: Python

    from plotly.io import show
    from sklearn.model_selection import train_test_split

    from skfolio import Population
    from skfolio.datasets import load_sp500_dataset
    from skfolio.optimization import DistributionallyRobustCVaR, EqualWeighted
    from skfolio.preprocessing import prices_to_returns

    prices = load_sp500_dataset()
    prices = prices["2020":]

    X = prices_to_returns(prices)
    X_train, X_test = train_test_split(X, test_size=0.5, shuffle=False)








.. GENERATED FROM PYTHON SOURCE LINES 48-52

Model
=====
We create four distributionally robust CVaR models with different radius then fit them
on the training set:

.. GENERATED FROM PYTHON SOURCE LINES 52-77

.. code-block:: Python

    model1 = DistributionallyRobustCVaR(
        wasserstein_ball_radius=0.1,
        portfolio_params=dict(name="Distributionally Robust CVaR - 0.1"),
    )
    model1.fit(X_train)

    model2 = DistributionallyRobustCVaR(
        wasserstein_ball_radius=0.01,
        portfolio_params=dict(name="Distributionally Robust CVaR - 0.01"),
    )
    model2.fit(X_train)

    model3 = DistributionallyRobustCVaR(
        wasserstein_ball_radius=0.001,
        portfolio_params=dict(name="Distributionally Robust CVaR - 0.001"),
    )
    model3.fit(X_train)

    model4 = DistributionallyRobustCVaR(
        wasserstein_ball_radius=0.0001,
        portfolio_params=dict(name="Distributionally Robust CVaR - 0.0001"),
    )
    model4.fit(X_train)
    model4.weights_





.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    array([4.84531907e-11, 1.01910610e-10, 1.81629430e-11, 7.56967308e-11,
           6.67249461e-11, 5.07087663e-10, 3.97503410e-02, 2.42882219e-09,
           3.84348572e-11, 8.53379955e-02, 5.85983398e-02, 3.38460704e-01,
           9.62545194e-11, 7.42768380e-11, 6.90123331e-10, 6.06982611e-10,
           4.16112642e-02, 1.18803064e-09, 4.36241349e-01, 1.34914228e-10])



.. GENERATED FROM PYTHON SOURCE LINES 78-80

To compare the models, we use an equal weighted benchmark using
the :class:`~skfolio.optimization.EqualWeighted` estimator:

.. GENERATED FROM PYTHON SOURCE LINES 80-84

.. code-block:: Python

    bench = EqualWeighted()
    bench.fit(X_train)
    bench.weights_





.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    array([0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05,
           0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05])



.. GENERATED FROM PYTHON SOURCE LINES 85-88

Prediction
==========
We predict the models and the benchmark on the test set:

.. GENERATED FROM PYTHON SOURCE LINES 88-94

.. code-block:: Python

    ptf_model1_test = model1.predict(X_test)
    ptf_model2_test = model2.predict(X_test)
    ptf_model3_test = model3.predict(X_test)
    ptf_model4_test = model4.predict(X_test)
    ptf_bench_test = bench.predict(X_test)








.. GENERATED FROM PYTHON SOURCE LINES 95-99

Analysis
========
We load all predicted portfolios into a :class:`~skfolio.population.Population` and
plot their compositions:

.. GENERATED FROM PYTHON SOURCE LINES 99-104

.. code-block:: Python

    population = Population(
        [ptf_model1_test, ptf_model2_test, ptf_model3_test, ptf_model4_test, ptf_bench_test]
    )
    population.plot_composition()






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
            <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.35.2.min.js"></script>                <div id="90d921b2-c7a1-4d50-8af8-8c72d9e1ac75" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("90d921b2-c7a1-4d50-8af8-8c72d9e1ac75")) {                    Plotly.newPlot(                        "90d921b2-c7a1-4d50-8af8-8c72d9e1ac75",                        [{"alignmentgroup":"True","hovertemplate":"asset=WMT\u003cbr\u003eindex=%{x}\u003cbr\u003evalue=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"WMT","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"WMT","offsetgroup":"WMT","orientation":"v","showlegend":true,"textposition":"auto","x":["Distributionally Robust CVaR - 0.1","Distributionally Robust CVaR - 0.01","Distributionally Robust CVaR - 0.001","Distributionally Robust CVaR - 0.0001","EqualWeighted"],"xaxis":"x","y":[0.050000000083713095,0.06250000018565098,0.14126843211109189,0.4362413488458863,0.05],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"asset=LLY\u003cbr\u003eindex=%{x}\u003cbr\u003evalue=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"LLY","marker":{"color":"#EF553B","pattern":{"shape":""}},"name":"LLY","offsetgroup":"LLY","orientation":"v","showlegend":true,"textposition":"auto","x":["Distributionally Robust CVaR - 0.1","Distributionally Robust CVaR - 0.01","Distributionally Robust CVaR - 0.001","Distributionally Robust CVaR - 0.0001","EqualWeighted"],"xaxis":"x","y":[0.05000000007216736,0.06250000018136548,0.14126841650429425,0.05859833984039582,0.05],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"asset=JNJ\u003cbr\u003eindex=%{x}\u003cbr\u003evalue=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"JNJ","marker":{"color":"#00cc96","pattern":{"shape":""}},"name":"JNJ","offsetgroup":"JNJ","orientation":"v","showlegend":true,"textposition":"auto","x":["Distributionally Robust CVaR - 0.1","Distributionally Robust CVaR - 0.01","Distributionally Robust CVaR - 0.001","Distributionally Robust CVaR - 0.0001","EqualWeighted"],"xaxis":"x","y":[0.05000000006271475,0.06250000017354727,0.14126833807908007,0.0,0.05],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"asset=MRK\u003cbr\u003eindex=%{x}\u003cbr\u003evalue=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"MRK","marker":{"color":"#ab63fa","pattern":{"shape":""}},"name":"MRK","offsetgroup":"MRK","orientation":"v","showlegend":true,"textposition":"auto","x":["Distributionally Robust CVaR - 0.1","Distributionally Robust CVaR - 0.01","Distributionally Robust CVaR - 0.001","Distributionally Robust CVaR - 0.0001","EqualWeighted"],"xaxis":"x","y":[0.05000000005860013,0.0625000001707063,0.14126841997828998,0.33846070446240595,0.05],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"asset=PG\u003cbr\u003eindex=%{x}\u003cbr\u003evalue=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"PG","marker":{"color":"#FFA15A","pattern":{"shape":""}},"name":"PG","offsetgroup":"PG","orientation":"v","showlegend":true,"textposition":"auto","x":["Distributionally Robust CVaR - 0.1","Distributionally Robust CVaR - 0.01","Distributionally Robust CVaR - 0.001","Distributionally Robust CVaR - 0.0001","EqualWeighted"],"xaxis":"x","y":[0.05000000005735549,0.06250000017530015,0.09841277264662632,0.0,0.05],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"asset=PFE\u003cbr\u003eindex=%{x}\u003cbr\u003evalue=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"PFE","marker":{"color":"#19d3f3","pattern":{"shape":""}},"name":"PFE","offsetgroup":"PFE","orientation":"v","showlegend":true,"textposition":"auto","x":["Distributionally Robust CVaR - 0.1","Distributionally Robust CVaR - 0.01","Distributionally Robust CVaR - 0.001","Distributionally Robust CVaR - 0.0001","EqualWeighted"],"xaxis":"x","y":[0.05000000005581804,0.06250000017290268,0.14063229511621947,0.0,0.05],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"asset=PEP\u003cbr\u003eindex=%{x}\u003cbr\u003evalue=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"PEP","marker":{"color":"#FF6692","pattern":{"shape":""}},"name":"PEP","offsetgroup":"PEP","orientation":"v","showlegend":true,"textposition":"auto","x":["Distributionally Robust CVaR - 0.1","Distributionally Robust CVaR - 0.01","Distributionally Robust CVaR - 0.001","Distributionally Robust CVaR - 0.0001","EqualWeighted"],"xaxis":"x","y":[0.0500000000346977,0.06250000015771885,0.0,0.0,0.05],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"asset=KO\u003cbr\u003eindex=%{x}\u003cbr\u003evalue=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"KO","marker":{"color":"#B6E880","pattern":{"shape":""}},"name":"KO","offsetgroup":"KO","orientation":"v","showlegend":true,"textposition":"auto","x":["Distributionally Robust CVaR - 0.1","Distributionally Robust CVaR - 0.01","Distributionally Robust CVaR - 0.001","Distributionally Robust CVaR - 0.0001","EqualWeighted"],"xaxis":"x","y":[0.05000000002605122,0.06250000015014603,0.09158957857074629,0.0853379955132948,0.05],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"asset=RRC\u003cbr\u003eindex=%{x}\u003cbr\u003evalue=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"RRC","marker":{"color":"#FF97FF","pattern":{"shape":""}},"name":"RRC","offsetgroup":"RRC","orientation":"v","showlegend":true,"textposition":"auto","x":["Distributionally Robust CVaR - 0.1","Distributionally Robust CVaR - 0.01","Distributionally Robust CVaR - 0.001","Distributionally Robust CVaR - 0.0001","EqualWeighted"],"xaxis":"x","y":[0.05000000002207055,0.06250000015907671,0.06841753217905626,0.04161126423753589,0.05],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"asset=HD\u003cbr\u003eindex=%{x}\u003cbr\u003evalue=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"HD","marker":{"color":"#FECB52","pattern":{"shape":""}},"name":"HD","offsetgroup":"HD","orientation":"v","showlegend":true,"textposition":"auto","x":["Distributionally Robust CVaR - 0.1","Distributionally Robust CVaR - 0.01","Distributionally Robust CVaR - 0.001","Distributionally Robust CVaR - 0.0001","EqualWeighted"],"xaxis":"x","y":[0.05000000001764584,0.06250000012357798,0.035874191890102304,0.03975034102460587,0.05],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"asset=AMD\u003cbr\u003eindex=%{x}\u003cbr\u003evalue=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"AMD","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"AMD","offsetgroup":"AMD","orientation":"v","showlegend":true,"textposition":"auto","x":["Distributionally Robust CVaR - 0.1","Distributionally Robust CVaR - 0.01","Distributionally Robust CVaR - 0.001","Distributionally Robust CVaR - 0.0001","EqualWeighted"],"xaxis":"x","y":[0.05000000000622631,0.06249999989112483,0.0,0.0,0.05],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"asset=MSFT\u003cbr\u003eindex=%{x}\u003cbr\u003evalue=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"MSFT","marker":{"color":"#EF553B","pattern":{"shape":""}},"name":"MSFT","offsetgroup":"MSFT","orientation":"v","showlegend":true,"textposition":"auto","x":["Distributionally Robust CVaR - 0.1","Distributionally Robust CVaR - 0.01","Distributionally Robust CVaR - 0.001","Distributionally Robust CVaR - 0.0001","EqualWeighted"],"xaxis":"x","y":[0.05000000000567293,0.06249999992611166,0.0,0.0,0.05],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"asset=BBY\u003cbr\u003eindex=%{x}\u003cbr\u003evalue=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"BBY","marker":{"color":"#00cc96","pattern":{"shape":""}},"name":"BBY","offsetgroup":"BBY","orientation":"v","showlegend":true,"textposition":"auto","x":["Distributionally Robust CVaR - 0.1","Distributionally Robust CVaR - 0.01","Distributionally Robust CVaR - 0.001","Distributionally Robust CVaR - 0.0001","EqualWeighted"],"xaxis":"x","y":[0.05000000000394708,0.06250000003663936,0.0,0.0,0.05],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"asset=AAPL\u003cbr\u003eindex=%{x}\u003cbr\u003evalue=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"AAPL","marker":{"color":"#ab63fa","pattern":{"shape":""}},"name":"AAPL","offsetgroup":"AAPL","orientation":"v","showlegend":true,"textposition":"auto","x":["Distributionally Robust CVaR - 0.1","Distributionally Robust CVaR - 0.01","Distributionally Robust CVaR - 0.001","Distributionally Robust CVaR - 0.0001","EqualWeighted"],"xaxis":"x","y":[0.049999999989236925,0.06249999954320146,0.0,0.0,0.05],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"asset=UNH\u003cbr\u003eindex=%{x}\u003cbr\u003evalue=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"UNH","marker":{"color":"#FFA15A","pattern":{"shape":""}},"name":"UNH","offsetgroup":"UNH","orientation":"v","showlegend":true,"textposition":"auto","x":["Distributionally Robust CVaR - 0.1","Distributionally Robust CVaR - 0.01","Distributionally Robust CVaR - 0.001","Distributionally Robust CVaR - 0.0001","EqualWeighted"],"xaxis":"x","y":[0.04999999996708052,0.062499999432034575,0.0,0.0,0.05],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"asset=XOM\u003cbr\u003eindex=%{x}\u003cbr\u003evalue=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"XOM","marker":{"color":"#19d3f3","pattern":{"shape":""}},"name":"XOM","offsetgroup":"XOM","orientation":"v","showlegend":true,"textposition":"auto","x":["Distributionally Robust CVaR - 0.1","Distributionally Robust CVaR - 0.01","Distributionally Robust CVaR - 0.001","Distributionally Robust CVaR - 0.0001","EqualWeighted"],"xaxis":"x","y":[0.049999999959127094,0.062499999414908004,0.0,0.0,0.05],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"asset=GE\u003cbr\u003eindex=%{x}\u003cbr\u003evalue=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"GE","marker":{"color":"#FF6692","pattern":{"shape":""}},"name":"GE","offsetgroup":"GE","orientation":"v","showlegend":true,"textposition":"auto","x":["Distributionally Robust CVaR - 0.1","Distributionally Robust CVaR - 0.01","Distributionally Robust CVaR - 0.001","Distributionally Robust CVaR - 0.0001","EqualWeighted"],"xaxis":"x","y":[0.049999999923986155,0.0,0.0,0.0,0.05],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"asset=JPM\u003cbr\u003eindex=%{x}\u003cbr\u003evalue=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"JPM","marker":{"color":"#B6E880","pattern":{"shape":""}},"name":"JPM","offsetgroup":"JPM","orientation":"v","showlegend":true,"textposition":"auto","x":["Distributionally Robust CVaR - 0.1","Distributionally Robust CVaR - 0.01","Distributionally Robust CVaR - 0.001","Distributionally Robust CVaR - 0.0001","EqualWeighted"],"xaxis":"x","y":[0.04999999991502842,0.0,0.0,0.0,0.05],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"asset=BAC\u003cbr\u003eindex=%{x}\u003cbr\u003evalue=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"BAC","marker":{"color":"#FF97FF","pattern":{"shape":""}},"name":"BAC","offsetgroup":"BAC","orientation":"v","showlegend":true,"textposition":"auto","x":["Distributionally Robust CVaR - 0.1","Distributionally Robust CVaR - 0.01","Distributionally Robust CVaR - 0.001","Distributionally Robust CVaR - 0.0001","EqualWeighted"],"xaxis":"x","y":[0.04999999987060067,0.0,0.0,0.0,0.05],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"asset=CVX\u003cbr\u003eindex=%{x}\u003cbr\u003evalue=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"CVX","marker":{"color":"#FECB52","pattern":{"shape":""}},"name":"CVX","offsetgroup":"CVX","orientation":"v","showlegend":true,"textposition":"auto","x":["Distributionally Robust CVaR - 0.1","Distributionally Robust CVaR - 0.01","Distributionally Robust CVaR - 0.001","Distributionally Robust CVaR - 0.0001","EqualWeighted"],"xaxis":"x","y":[0.04999999986826016,0.0,0.0,0.0,0.05],"yaxis":"y","type":"bar"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Portfolios"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Weight"},"tickformat":",.0%"},"legend":{"title":{"text":"asset"},"tracegroupgap":0,"yanchor":"top","y":0.99,"xanchor":"left","x":1.15},"margin":{"t":60},"barmode":"relative","title":{"text":"Portfolios Composition"}},                        {"responsive": true}                    )                };                            </script>        </div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 105-109

We can see that by increasing the radius of the Wasserstein ball, the weights get
closer to the equal weighted portfolio.

Let's plot the portfolios cumulative returns:

.. GENERATED FROM PYTHON SOURCE LINES 109-111

.. code-block:: Python

    fig = population.plot_cumulative_returns()
    show(fig)



.. raw:: html
    :file: images/sphx_glr_plot_1_distributionally_robust_cvar_001.html






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 14.184 seconds)


.. _sphx_glr_download_auto_examples_4_distributionally_robust_cvar_plot_1_distributionally_robust_cvar.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: binder-badge

      .. image:: images/binder_badge_logo.svg
        :target: https://mybinder.org/v2/gh/skfolio/skfolio/gh-pages?urlpath=lab/tree/notebooks/auto_examples/4_distributionally_robust_cvar/plot_1_distributionally_robust_cvar.ipynb
        :alt: Launch binder
        :width: 150 px

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_1_distributionally_robust_cvar.ipynb <plot_1_distributionally_robust_cvar.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_1_distributionally_robust_cvar.py <plot_1_distributionally_robust_cvar.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: plot_1_distributionally_robust_cvar.zip <plot_1_distributionally_robust_cvar.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
