
<!DOCTYPE html>


<html lang="en" data-theme="dark">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="shortcut icon" type="image/svg+xml" sizes="any" href="../_static/favicon.svg">
    <link rel="icon" type="image/svg+xml" sizes="any" href="../_static/favicon.svg">
    <link rel="icon" type="image/png" sizes="144x144" href="../_static/favicon.png"><meta property="og:title" content="Prior Estimator" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://skfolio.org/user_guide/prior.html" />
<meta property="og:site_name" content="skfolio" />
<meta property="og:description" content="A prior estimator fits a PriorModel containing the distribution estimate of asset returns. It represents the investor’s prior beliefs about the model used to estimate that distribution. A prior est..." />
<meta property="og:image" content="https://skfolio.org/_images/expo.jpg" />
<meta property="og:image:alt" content="skfolio" />
<meta name="description" content="A prior estimator fits a PriorModel containing the distribution estimate of asset returns. It represents the investor’s prior beliefs about the model used to estimate that distribution. A prior est..." />

    <title>Prior Estimator &#8212; skfolio 0.5.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "dark";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=0f37f9aa" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script src="../_static/documentation_options.js?v=f7ee7eb5"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'user_guide/prior';</script>
    <link rel="canonical" href="https://skfolio.org/user_guide/prior.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Expected Return Estimator" href="expected_returns.html" />
    <link rel="prev" title="Population" href="population.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="dark">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>


  <div class="bd-header-announcement container-fluid bd-header-announcement">
    <div class="bd-header-announcement__content"><div class="sidebar-message">
    If you'd like to contribute,
    <a href="https://github.com/skfolio/skfolio">check out our GitHub repository.</a>
    Your contributions are welcome!</div></div>
  </div>

  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  <div class="navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
    
    
    
    <img src="../_static/favicon.svg" class="logo__image only-dark" alt="skfolio documentation - Home"/>
    <script>document.write(`<img src="../_static/favicon.svg" class="logo__image only-light" alt="skfolio documentation - Home"/>`);</script>
  
  
    <p class="title logo__title">skfolio</p>
  
</a></div>
    
  </div>
  
  
  <div class=" navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="index.html">
                         User guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../auto_examples/index.html">
                         Examples
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../api.html">
                         API Reference
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/skfolio/skfolio" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
    </div>
  

  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="index.html">
                         User guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../auto_examples/index.html">
                         Examples
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../api.html">
                         API Reference
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/skfolio/skfolio" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="install.html">Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="optimization.html">Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="portfolio.html">Portfolio</a></li>
<li class="toctree-l1"><a class="reference internal" href="population.html">Population</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Prior</a></li>
<li class="toctree-l1"><a class="reference internal" href="expected_returns.html">Expected Returns</a></li>
<li class="toctree-l1"><a class="reference internal" href="covariance.html">Covariance</a></li>
<li class="toctree-l1"><a class="reference internal" href="distance.html">Distance</a></li>
<li class="toctree-l1"><a class="reference internal" href="cluster.html">Clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="uncertainty_set.html">Uncertainty Set</a></li>
<li class="toctree-l1"><a class="reference internal" href="pre_selection.html">Pre-Selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="model_selection.html">Model Selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="hyper_parameters_tuning.html">Hyper-Parameters Tuning</a></li>
<li class="toctree-l1"><a class="reference internal" href="metadata_routing.html">Metadata Routing</a></li>
<li class="toctree-l1"><a class="reference internal" href="datasets.html">Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_preparation.html">Data Preparation</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumbs">
  <ul class="bd-breadcrumbs" role="navigation" aria-label="Breadcrumb">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">User Guide</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Prior Estimator</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="prior-estimator">
<span id="prior"></span><h1>Prior Estimator<a class="headerlink" href="#prior-estimator" title="Link to this heading">#</a></h1>
<p>A prior estimator fits a <a class="reference internal" href="../generated/skfolio.prior.PriorModel.html#skfolio.prior.PriorModel" title="skfolio.prior.PriorModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">PriorModel</span></code></a> containing the distribution estimate of
asset returns. It represents the investor’s prior beliefs about the model used to
estimate that distribution.</p>
<p>A prior estimator follows the same API as scikit-learn’s <code class="docutils literal notranslate"><span class="pre">estimator</span></code>: the <code class="docutils literal notranslate"><span class="pre">fit</span></code> method
takes <code class="docutils literal notranslate"><span class="pre">X</span></code> as the assets returns and stores the <a class="reference internal" href="../generated/skfolio.prior.PriorModel.html#skfolio.prior.PriorModel" title="skfolio.prior.PriorModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">PriorModel</span></code></a> in its
<code class="docutils literal notranslate"><span class="pre">prior_model_</span></code> attribute.</p>
<p><code class="docutils literal notranslate"><span class="pre">X</span></code> can be any array-like structure (numpy array, pandas DataFrame, etc.)</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The prior of one model can be the posterior of another one. For example,
<a class="reference internal" href="../generated/skfolio.prior.BlackLitterman.html#skfolio.prior.BlackLitterman" title="skfolio.prior.BlackLitterman"><code class="xref py py-class docutils literal notranslate"><span class="pre">BlackLitterman</span></code></a> takes as input a prior estimator used to compute the prior
expected returns and prior covariance matrix, which are updated using the analyst’s
views to get the posterior expected returns and posterior covariance matrix. These
posterior estimates will be saved in a new <a class="reference internal" href="../generated/skfolio.prior.PriorModel.html#skfolio.prior.PriorModel" title="skfolio.prior.PriorModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">PriorModel</span></code></a> that can be used in
another estimator.</p>
</div>
<p>The <a class="reference internal" href="../generated/skfolio.prior.PriorModel.html#skfolio.prior.PriorModel" title="skfolio.prior.PriorModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">PriorModel</span></code></a> is a dataclass containing:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">mu</span></code>: Expected returns estimation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">covariance</span></code>: Covariance matrix estimation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">returns</span></code>: assets returns estimation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cholesky</span></code> : Lower-triangular Cholesky factor of the covariance estimation (optional)</p></li>
</ul>
</div></blockquote>
<section id="empirical-prior">
<h2>Empirical Prior<a class="headerlink" href="#empirical-prior" title="Link to this heading">#</a></h2>
<p>The <a class="reference internal" href="../generated/skfolio.prior.EmpiricalPrior.html#skfolio.prior.EmpiricalPrior" title="skfolio.prior.EmpiricalPrior"><code class="xref py py-class docutils literal notranslate"><span class="pre">EmpiricalPrior</span></code></a> estimator estimates the <a class="reference internal" href="../generated/skfolio.prior.PriorModel.html#skfolio.prior.PriorModel" title="skfolio.prior.PriorModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">PriorModel</span></code></a> by fitting a
<code class="docutils literal notranslate"><span class="pre">mu_estimator</span></code> and a <code class="docutils literal notranslate"><span class="pre">covariance_estimator</span></code> separately.</p>
<p><strong>Example:</strong></p>
<p>Empirical prior with James-Stein shrinkage for the estimation of expected returns and
Denoising for the estimation of the covariance matrix:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">skfolio.datasets</span> <span class="kn">import</span> <span class="n">load_sp500_dataset</span>
<span class="kn">from</span> <span class="nn">skfolio.moments</span> <span class="kn">import</span> <span class="n">DenoiseCovariance</span><span class="p">,</span> <span class="n">ShrunkMu</span>
<span class="kn">from</span> <span class="nn">skfolio.preprocessing</span> <span class="kn">import</span> <span class="n">prices_to_returns</span>
<span class="kn">from</span> <span class="nn">skfolio.prior</span> <span class="kn">import</span> <span class="n">EmpiricalPrior</span>

<span class="n">prices</span> <span class="o">=</span> <span class="n">load_sp500_dataset</span><span class="p">()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">prices_to_returns</span><span class="p">(</span><span class="n">prices</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">EmpiricalPrior</span><span class="p">(</span>
    <span class="n">mu_estimator</span><span class="o">=</span><span class="n">ShrunkMu</span><span class="p">(),</span> <span class="n">covariance_estimator</span><span class="o">=</span><span class="n">DenoiseCovariance</span><span class="p">()</span>
<span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">prior_model_</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="black-litterman">
<h2>Black &amp; Litterman<a class="headerlink" href="#black-litterman" title="Link to this heading">#</a></h2>
<p>The <a class="reference internal" href="../generated/skfolio.prior.BlackLitterman.html#skfolio.prior.BlackLitterman" title="skfolio.prior.BlackLitterman"><code class="xref py py-class docutils literal notranslate"><span class="pre">BlackLitterman</span></code></a> estimator estimates the <a class="reference internal" href="../generated/skfolio.prior.PriorModel.html#skfolio.prior.PriorModel" title="skfolio.prior.PriorModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">PriorModel</span></code></a> using the
Black &amp; Litterman model. It takes a Bayesian approach by using a prior estimate
of the assets expected returns and covariance matrix, which are updated using the
analyst views to get the posterior estimates.</p>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">skfolio.preprocessing</span> <span class="kn">import</span> <span class="n">prices_to_returns</span>
<span class="kn">from</span> <span class="nn">skfolio.datasets</span> <span class="kn">import</span> <span class="n">load_sp500_dataset</span>
<span class="kn">from</span> <span class="nn">skfolio.prior</span> <span class="kn">import</span> <span class="n">BlackLitterman</span>

<span class="n">prices</span> <span class="o">=</span> <span class="n">load_sp500_dataset</span><span class="p">()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">prices_to_returns</span><span class="p">(</span><span class="n">prices</span><span class="p">)</span>

<span class="n">analyst_views</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;AAPL - BBY == 0.0003&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CVX - KO == 0.0004&quot;</span><span class="p">,</span>
    <span class="s2">&quot;MSFT == 0.0006&quot;</span><span class="p">,</span>
<span class="p">]</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">BlackLitterman</span><span class="p">(</span><span class="n">views</span><span class="o">=</span><span class="n">analyst_views</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">prior_model_</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="factor-model">
<h2>Factor Model<a class="headerlink" href="#factor-model" title="Link to this heading">#</a></h2>
<p>The <a class="reference internal" href="../generated/skfolio.prior.FactorModel.html#skfolio.prior.FactorModel" title="skfolio.prior.FactorModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">FactorModel</span></code></a> estimator estimates the <a class="reference internal" href="../generated/skfolio.prior.PriorModel.html#skfolio.prior.PriorModel" title="skfolio.prior.PriorModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">PriorModel</span></code></a> using a factor
model and a <a class="reference internal" href="#prior"><span class="std std-ref">prior estimator</span></a> of the factor’s returns.</p>
<p>The purpose of factor models is to impose a structure on financial variables and
their covariance matrix by explaining them through a small number of common factors.
This can help overcome estimation error by reducing the number of parameters,
i.e., the dimensionality of the estimation problem, making portfolio optimization
more robust against noise in the data. Factor models also provide a decomposition of
financial risk into systematic and security-specific components.</p>
<p>To be fully compatible with <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code>, the <code class="docutils literal notranslate"><span class="pre">fit</span></code> method takes <code class="docutils literal notranslate"><span class="pre">X</span></code> as the assets
returns and <code class="docutils literal notranslate"><span class="pre">y</span></code> as the factors returns. Note that <code class="docutils literal notranslate"><span class="pre">y</span></code> is in lowercase even for a 2D
array (more than one factor). This is for consistency with the scikit-learn API.</p>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">skfolio.datasets</span> <span class="kn">import</span> <span class="n">load_factors_dataset</span><span class="p">,</span> <span class="n">load_sp500_dataset</span>
<span class="kn">from</span> <span class="nn">skfolio.preprocessing</span> <span class="kn">import</span> <span class="n">prices_to_returns</span>
<span class="kn">from</span> <span class="nn">skfolio.prior</span> <span class="kn">import</span> <span class="n">FactorModel</span>

<span class="n">prices</span> <span class="o">=</span> <span class="n">load_sp500_dataset</span><span class="p">()</span>
<span class="n">factor_prices</span> <span class="o">=</span> <span class="n">load_factors_dataset</span><span class="p">()</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">prices_to_returns</span><span class="p">(</span><span class="n">prices</span><span class="p">,</span> <span class="n">factor_prices</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">FactorModel</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">prior_model_</span><span class="p">)</span>
</pre></div>
</div>
<p>The loading matrix (betas) of the factors is estimated using a
<code class="docutils literal notranslate"><span class="pre">loading_matrix_estimator</span></code>. By default, we use the <a class="reference internal" href="../generated/skfolio.prior.LoadingMatrixRegression.html#skfolio.prior.LoadingMatrixRegression" title="skfolio.prior.LoadingMatrixRegression"><code class="xref py py-class docutils literal notranslate"><span class="pre">LoadingMatrixRegression</span></code></a>
which fits the factors using a <code class="xref py py-class docutils literal notranslate"><span class="pre">sklean.linear_model.LassoCV</span></code> on each asset
separately.</p>
</section>
<section id="combining-multiple-prior-estimators">
<h2>Combining Multiple Prior Estimators<a class="headerlink" href="#combining-multiple-prior-estimators" title="Link to this heading">#</a></h2>
<p>Prior estimators can be combined. For example, it is possible to create a Black &amp;
Litterman Factor Model by using a <a class="reference internal" href="../generated/skfolio.prior.BlackLitterman.html#skfolio.prior.BlackLitterman" title="skfolio.prior.BlackLitterman"><code class="xref py py-class docutils literal notranslate"><span class="pre">BlackLitterman</span></code></a> estimator for the prior
estimator of the <a class="reference internal" href="../generated/skfolio.prior.FactorModel.html#skfolio.prior.FactorModel" title="skfolio.prior.FactorModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">FactorModel</span></code></a>:</p>
<p><strong>Example:</strong></p>
<p>Factor model for the estimation of the <strong>assets</strong> expected returns and covariance matrix
with a Black &amp; Litterman model for the estimation of the <strong>factors</strong> expected reruns and
covariance matrix, incorporating the analyst views on the <strong>factors</strong>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">skfolio.datasets</span> <span class="kn">import</span> <span class="n">load_factors_dataset</span><span class="p">,</span> <span class="n">load_sp500_dataset</span>
<span class="kn">from</span> <span class="nn">skfolio.preprocessing</span> <span class="kn">import</span> <span class="n">prices_to_returns</span>
<span class="kn">from</span> <span class="nn">skfolio.prior</span> <span class="kn">import</span> <span class="n">BlackLitterman</span><span class="p">,</span> <span class="n">FactorModel</span>

<span class="n">prices</span> <span class="o">=</span> <span class="n">load_sp500_dataset</span><span class="p">()</span>
<span class="n">factor_prices</span> <span class="o">=</span> <span class="n">load_factors_dataset</span><span class="p">()</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">prices_to_returns</span><span class="p">(</span><span class="n">prices</span><span class="p">,</span> <span class="n">factor_prices</span><span class="p">)</span>

<span class="n">views</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;MTUM - QUAL == 0.0003&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SIZE - USMV == 0.0004&quot;</span><span class="p">,</span>
    <span class="s2">&quot;VLUE == 0.0006&quot;</span><span class="p">,</span>
<span class="p">]</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">FactorModel</span><span class="p">(</span>
    <span class="n">factor_prior_estimator</span><span class="o">=</span><span class="n">BlackLitterman</span><span class="p">(</span><span class="n">views</span><span class="o">=</span><span class="n">views</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">prior_model_</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>


                </article>
              
              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="population.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Population</p>
      </div>
    </a>
    <a class="right-next"
       href="expected_returns.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Expected Return Estimator</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="copyright">
    
      © Copyright 2023, skfolio developers (BSD License).
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">
  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.13.3.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>